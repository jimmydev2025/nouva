(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2874],{290:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/[app_id]/embedded-wallets",function(){return t(79847)}])},79847:(e,a,t)=>{"use strict";t.r(a),t.d(a,{__N_SSP:()=>ep,default:()=>ey});var r=t(31085),n=t(2657),i=t.n(n),d=t(19684),o=t(14041),l=t(79629),s=t(31586),c=t(38293),p=t(36073),y=t(8614),_=t(60286),u=t(65749);let w=(e,a)=>{throw null!=a?a:Error("Expected never, got: ".concat(e))};var v=t(1048).Buffer;function h(e){let{message:a,privateKey:t,chainType:r}=e;return"bitcoin-segwit"===r?u.secp256k1.sign(v.from(a),t).toDERRawBytes():"bitcoin-taproot"===r?u.ko.sign(v.from(a),t):w(r)}async function I(e){let{appId:a,appClientId:t,accessToken:r,hdWalletIndex:n,chainType:i,entropy:d}=e,o=(0,_.E)({entropy:d,index:n,pathType:"bitcoin-taproot"===i?"taproot":"segwit"}),l=await (0,y.QQ)({appId:a,appClientId:t,accessToken:r,address:o.address,chainType:i}),s=function(e){let{domain:a,publicKeyHex:t,address:r,uri:n,nonce:i,issuedAt:d}=e;return"".concat(a," wants you to sign in with your Bitcoin account:\n").concat(t,"\n\nYou are proving you own ").concat(r,".\n\nURI: ").concat(n,"\nVersion: 1\nNonce: ").concat(i,"\nIssued At: ").concat(null!=d?d:new Date().toISOString(),"\nChain ID: ").concat("000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f","\nResources:\n- https://privy.io")}({domain:window.location.host,publicKeyHex:(0,c.My)(o.publicKey),uri:window.location.origin,address:o.address,nonce:l}),u=h({message:s,privateKey:o.privateKey,chainType:i});return await (0,y.Zn)({appId:a,appClientId:t,accessToken:r,data:{message:s,signature:p.K3.encode(u),chain_type:i,hd_node_index:n}})}var f=t(82926),m=t.n(f),g=t(69955),A=t(96439),T=t(1048).Buffer;async function E(e){let{appId:a,appClientId:t,accessToken:r,hdWalletIndex:n,entropy:i}=e;if(n<=0)throw new A.Pi("invalid_request_arguments","Failed to create additional wallet: invalid wallet index");let d=(0,g.kG)({entropy:i,index:n}),o=d.publicKey.toBase58(),l=await y.QQ({appId:a,appClientId:t,accessToken:r,address:o,chainType:"solana"}),s=(0,g.zT)(window.location.host,window.location.origin,o,l),c=m().sign.detached(T.from(s),d.secretKey);return await y.Zn({appId:a,appClientId:t,accessToken:r,data:{message:s,signature:p.K3.encode(c),hd_node_index:n,chain_type:"solana"}}),{keypair:d,address:o}}var P=t(45379),N=t(43392);let D=p.K3.decode(N.A.DELEGATED_ACTIONS_TEE_PUBLIC_KEY||""),O=async e=>{let{entropy:a,delegatedWallets:t,appId:r,appClientId:n,accessToken:i}=e,[d,o]=await (0,g.uY)(a);if("string"!=typeof N.A.DELEGATED_ACTIONS_TEE_PUBLIC_KEY)throw new A.Pi("error","Cannot delegate wallet actions - NEXT_PUBLIC_DELEGATED_ACTIONS_TEE_PUBLIC_KEY is not set.");let l=(0,P.Lv)(D,p.K3.encode(o));await (0,y.IW)({appId:r,appClientId:n,accessToken:i,data:{app_share:p.K3.encode(d),encrypted_tee_share:l,delegated_addresses:t.map(e=>{let{address:a,chainType:t,walletIndex:r}=e;return{address:a,chain_type:t,wallet_index:r}})}})};var b=t(34217);async function C(e){let a=(0,g.eB)({entropy:e,opts:{path:"m/3457'/10'/1'/0/".concat(0)}}).getHdKey().privateKey;return{publicKey:await (0,b.Rn)(a),privateKey:a}}async function S(e){let{appId:a,appClientId:t,entropy:r,accessToken:n}=e,{publicKey:i}=await C(r);return await y.aV({appId:a,appClientId:t,signerPublicKey:"0x".concat(b.jn.bytesToHex(i)),auth:{accessToken:n,mfaToken:null}})}var x=t(64942),K=t(46195),R=t(1048).Buffer;let M=K.z.string().regex(/^[A-Za-z0-9+/]*={0,2}\.[A-Za-z0-9+/]*={0,2}$/,{message:"Must be two base64 strings separated by a single period"});var L=t(55345);async function k(e,a){let{privateKey:t,chainType:r}=e;switch(a.method){case"sign":return{method:a.method,data:{signature:p.K3.encode(h({privateKey:t,message:a.params.message,chainType:r}))}};case"signTransaction":return{method:a.method,data:{signedTransaction:function(e){let{txAsPSBTHexString:a,privateKey:t}=e,r=L.ZX.fromPSBT((0,c.aT)(a),{allowLegacyWitnessUtxo:!0});return r.sign(t),r.finalize(),r.hex}({txAsPSBTHexString:a.params.psbt,privateKey:t})}}}}var V=t(21435),U=t(16894);async function W(e,a){if("ethereum"===a.chainType&&"ethereum"===e.chainType)return await (0,V.A)(e,a.request);if("solana"===a.chainType&&"solana"===e.chainType)return await (0,U.A)(e.wallet.keypair,{...a,publicKey:a.entropyId,signingPublicKey:e.wallet.address});if("bitcoin-segwit"===a.chainType&&"bitcoin-segwit"===e.chainType||"bitcoin-taproot"===a.chainType&&"bitcoin-taproot"===e.chainType)return await k({privateKey:e.wallet.privateKey,chainType:a.chainType},a.request);throw new A.Pi("invalid_request_arguments","Unknown chain type")}var G=t(98501);async function q(e){let{appId:a,userId:t,address:r}=e;if(!(0,g.qi)(r)&&!(0,g.Zf)(r))throw new A.Pi("invalid_request_arguments","Failed to initialize wallet: missing or invalid wallet address");if(!G.A.get({appId:a,userId:t,address:r}))throw new A.Pi("wallet_not_on_device","Failed to initialize wallet: wallet with address '".concat(r,"' not loaded on this device"))}var B=t(51691);let F={ethereum:{createFromPrivateKey:g.Bt,createSiwxMessage:g.t5},solana:{createFromPrivateKey:g.UI,createSiwxMessage:g.zT}};async function Y(e){let{appId:a,appClientId:t,userId:r,accessToken:n,privateKey:i,chainType:d}=e,{createFromPrivateKey:o,createSiwxMessage:l}=F[d],s=await o(i),{deviceShares:c,recoveryShares:_,wallet:u,entropy:w,signMessage:v}=s,h="address"in s?s.address:s.wallet.address,[I,f]=c,[m,A]=_,[T,{encryptionKey:E,walletRecoveryOutput:P}]=await Promise.all([y.QQ({appId:a,appClientId:t,accessToken:n,address:h,chainType:d}),(0,B.cq)({recoveryType:"privy_generated_recovery_key"})]),[N,D]=await Promise.all([(0,g.EN)(E),(0,g.vb)(m,E)]),O=l(window.location.host,window.location.origin,h,T),b=await v({message:O}),C=(0,g.hE)(),{recovery_key:S}=await (0,B.qz)(P);return await y.gc({appId:a,appClientId:t,accessToken:n,data:{chain_type:d,message:O,signature:b,device_id:C,device_auth_share:p.K3.encode(f),recovery_auth_share:p.K3.encode(A),encrypted_recovery_share:p.K3.encode(D.encryptedShare),encrypted_recovery_share_iv:p.K3.encode(D.encryptedShareIV),recovery_type:"privy_generated_recovery_key",recovery_key_hash:p.K3.encode(N),recovery_key:S,imported:!0}}),G.A.set({appId:a,userId:r,address:h},{share:p.K3.encode(I),deviceId:C}),{chainType:d,entropyType:"private-key",wallet:u,entropy:w,walletIndex:void 0}}var z=t(35438);async function J(e){var a;let{appId:t,appClientId:r,accessToken:n,mfaCode:i,mfaMethod:d,userId:o,relyingParty:l}=e;if(i&&d)try{let e=await y.j2({appId:t,appClientId:r,accessToken:n,method:d,code:i,relyingParty:l});return z.A.set({appId:t,userId:o},e),e.token}catch(e){throw z.A.del({appId:t,userId:o}),new A.Pi("missing_or_invalid_mfa","MFA verification failed")}return(null===(a=z.A.get({appId:t,userId:o}))||void 0===a?void 0:a.token)||(z.A.del({appId:t,userId:o}),null)}async function H(e){let{mfaCode:a,mfaMethod:t,...r}=e,n=await J({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,mfaCode:a,mfaMethod:t,userId:r.userId,relyingParty:r.relyingParty});switch(r.method){case"sms":return await y.St({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,phoneNumber:r.phoneNumber,mfaToken:n});case"totp":return await y.O({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,mfaToken:n});default:throw Error("Unknown mfa method")}}var j=t(69899);async function $(e){switch(e.method){case"sms":return await y._o({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,code:e.code,phoneNumber:e.phoneNumber});case"totp":return await y.q$({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,code:e.code});case"passkey":let a=await J({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,mfaCode:null,mfaMethod:null,relyingParty:"",userId:e.userId});await y.NB({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,credentialIds:e.credentialIds,removeForLogin:e.removeForLogin,mfaToken:a}),0===e.credentialIds.length&&z.A.del({appId:e.appId,userId:e.userId});return;default:throw Error("Unknown mfa method")}}function X(e){if("hd-entropy"!==e.entropyType)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.")}async function Q(e){let{appId:a,appClientId:t,userId:r,accessToken:n,method:i,mfaCode:d,mfaMethod:o,relyingParty:l}=e,s=await J({appId:a,appClientId:t,accessToken:n,mfaCode:d,mfaMethod:o,userId:r,relyingParty:l}),c=await Z({appId:a,appClientId:t,accessToken:n,method:i,mfaToken:s});return z.A.del({appId:a,userId:r}),c}async function Z(e){let{appId:a,appClientId:t,accessToken:r,method:n,mfaToken:i}=e;switch(n){case"sms":return await y.jE({appId:a,appClientId:t,accessToken:r,mfaToken:i});case"totp":return await y.hH({appId:a,appClientId:t,accessToken:r,mfaToken:i});default:throw Error("Unknown mfa method")}}async function ee(e){let{mfaMethod:a,mfaCode:t,relyingParty:r,...n}=e,i=await J({appId:n.appId,appClientId:n.appClientId,accessToken:n.accessToken,userId:n.userId,mfaCode:t,mfaMethod:a,relyingParty:r});await y.v$({appId:n.appId,appClientId:n.appClientId,accessToken:n.accessToken,credentialId:n.credentialId,removeAsMfa:n.removeAsMfa,mfaToken:i}),z.A.del({appId:n.appId,userId:n.userId})}var ea=t(63814);function et(e){let{allowedOrigins:a,url:t}=e,r=new URL(t);if(0===a.length||a.some(e=>"*"===e.trim()))return!0;for(let e of a)if(r.origin===e||(function(e){let a=e.replace(/\./g,"\\.").replace(/\*/g,"[^.]*");return new RegExp("^".concat(a,"$"))})(e).test(r.origin))return!0;return!1}function er(e){return!!e.ReactNativeWebView&&e.top===e}function en(e){return er(e)&&navigator.userAgent.includes("Android")}function ei(e){let{PRIVY_NATIVE_IOS:a,PRIVY_NATIVE_ANDROID:t,PRIVY_UNITY:r}=e;return t?"native-android":a?"native-ios":r?"unity":en(e)?"expo-android":er(e)?"expo-ios":"web"}let ed={"privy:wallet:create":"embedded_wallet_iframe_create","privy:wallet:create-additional":"embedded_wallet_iframe_create_additional","privy:wallet:import":"embedded_wallet_iframe_import","privy:wallet:set-recovery-password":"embedded_wallet_iframe_set_recovery_password","privy:wallet:set-recovery":"embedded_wallet_iframe_set_recovery","privy:wallet:recover":"embedded_wallet_iframe_recover","privy:wallet:rpc":"embedded_wallet_iframe_rpc","privy:solana-wallet:create":"embedded_solana_wallet_iframe_create","privy:solana-wallet:create-additional":"embedded_solana_wallet_iframe_create_additional","privy:solana-wallet:recover":"embedded_wallet_iframe_solana_recover","privy:solana-wallet:rpc":"embedded_solana_wallet_iframe_rpc","privy:farcaster:init-signer":"embedded_wallet_iframe_farcaster_signer_init","privy:farcaster:sign":"embedded_wallet_iframe_farcaster_sign","privy:delegated-actions:consent":"embedded_wallet_iframe_delegated_actions_consent","privy:wallets:create":"embedded_wallet_iframe_create","privy:wallets:add":"embedded_wallet_iframe_create_additional","privy:wallets:import":"embedded_wallet_iframe_import","privy:wallets:set-recovery":"embedded_wallet_iframe_set_recovery","privy:wallets:connect":"embedded_wallet_iframe_connect","privy:wallets:recover":"embedded_wallet_iframe_recover","privy:wallets:rpc":"embedded_wallet_iframe_rpc"};function eo(e,a){var t,r,n,i,d;if(window.PRIVY_NATIVE_IOS)try{return null===(t=window.webkit)||void 0===t?void 0:t.messageHandlers.iOSProxy.postMessage(JSON.stringify(e))}catch(e){}if(window.PRIVY_NATIVE_ANDROID)try{return null===(r=window.AndroidProxy)||void 0===r?void 0:r.postMessage(JSON.stringify(e))}catch(e){}if(window.PRIVY_UNITY)try{return null===(n=window.UnityProxy)||void 0===n?void 0:n.postMessage(JSON.stringify(e))}catch(e){}if(er(window))try{return null===(d=window.ReactNativeWebView)||void 0===d?void 0:null===(i=d.postMessage)||void 0===i?void 0:i.call(d,JSON.stringify(e))}catch(e){}setTimeout(()=>{window.parent&&window.parent.postMessage(e,a)},0)}function el(e,a,t,r){eo({id:a,event:t,data:r},e.origin)}function es(e,a,t,r){eo({id:a,event:t,error:{type:(0,A.xR)(r)?r.type:A.z6,message:r.message}},e.origin)}function ec(e){let a=(0,o.useRef)(null),t=(0,o.useRef)(e.verificationKeys);function r(e,t,r){z.A.get({appId:e,userId:t})?a.current=null:a.current=r}return(0,o.useEffect)(()=>{t.current=e.verificationKeys},[e.verificationKeys]),(0,o.useEffect)(()=>{var e;let a=window.location.href.startsWith("http://localhost"),t=[...null!==(e=location.ancestorOrigins)&&void 0!==e?e:[]].some(e=>e.startsWith("http://localhost"));a||t||(console.log("%cWarning!","color:#F16552; font-size:50px; font-weight: bold; -webkit-text-stroke: 1px black;"),console.log("%cYou are reading this message because you opened the browser console, a developer tool. Do not enter or paste code you do not understand. Never share your tokens or any other info with anyone. If someone told you to do this, it is very likely a scam.","font-size: 18px;"))},[]),(0,o.useEffect)(()=>{let n=e.appClientId;async function i(i){var o,c,p,_,u,v,h,f;if(!i)return;let m="string"==typeof i.data?JSON.parse(i.data):i.data;if(!("string"==typeof m.event&&/^privy:.+/.test(m.event))||(h=e.allowedDomains,!(window.PRIVY_NATIVE_IOS||window.PRIVY_NATIVE_ANDROID||window.PRIVY_UNITY||er(window)||et({allowedOrigins:h,url:i.origin}))))return;if(!(0===(f=e.allowedDomains||[]).length?!(void 0!==location.ancestorOrigins&&location.ancestorOrigins.length>1):void 0===location.ancestorOrigins||!(location.ancestorOrigins.length>0)||[...location.ancestorOrigins].every(e=>et({allowedOrigins:f,url:e}))))return es(i,m.id,m.event,new l.D_("Frame ancestor is not allowed"));if("privy:iframe:ready"===m.event)return el(i,m.id,m.event,{});if("privy:mfa:clear"===m.event){let a=m.data.userId.replace(/^did:privy:/,"");return z.A.del({appId:e.appId,userId:a}),el(i,m.id,m.event,{})}let g=m.data.accessToken;if(!g)return es(i,m.id,m.event,new l.D_("Missing auth token."));let T=await (0,ea.d)(g,t.current,e.appId);if(!T)return es(i,m.id,m.event,new l.D_("Invalid auth token."));let{userId:P,appId:N}=T;try{let t=null!==(o=ed[m.event])&&void 0!==o?o:"embedded_wallet_iframe_invalid_event",l=(a,t)=>(0,y.$1)({appId:N,appClientId:n,accessToken:g,clientId:e.clientAnalyticsId,eventName:a,payload:t});switch(m.event){case"privy:wallets:create":return es(i,m.id,m.event,new A.Pi("error","Not implemented"));case"privy:wallets:add":{let{entropy:t,entropyType:r}=await (0,j.A)({...m.data,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,cache:a.current});if("private-key"===r)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.");if("bitcoin-taproot"===m.data.chainType||"bitcoin-segwit"===m.data.chainType){let{address:e}=await I({...m.data,appId:N,appClientId:n,entropy:t,chainType:m.data.chainType});return el(i,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}if("ethereum"===m.data.chainType){let{address:e}=await (0,s.h6)({...m.data,appId:N,appClientId:n,entropy:t});return el(i,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}if("solana"===m.data.chainType){let{address:e}=await E({...m.data,appId:N,appClientId:n,entropy:t});return el(i,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}return w(m.data.chainType,new A.Pi("invalid_request_arguments","Unknown chain type"))}case"privy:wallets:connect":return await q({appId:N,userId:P,address:m.data.entropyId}),el(i,m.id,m.event,{entropyId:m.data.entropyId});case"privy:wallets:set-recovery":{let{entropy:r,entropyType:d}=await (0,j.A)({cache:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if("ethereum-address-verifier"!==m.data.entropyIdVerifier&&"solana-address-verifier"!==m.data.entropyIdVerifier)throw new A.Pi("invalid_request_arguments","Unexpected entropy ID type: ".concat(m.data.entropyIdVerifier));if("private-key"===d)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.");let o=await (0,s._U)({appId:N,appClientId:n,userId:P,accessToken:g,entropy:r,entropyId:m.data.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,clientType:ei(window),recoveryOptions:m.data,createWalletEvent:l});return l("".concat(t,"_completed"),{address:o.entropyId,existingRecoveryMethod:m.data.existingRecoveryMethod,targetRecoveryMethod:m.data.recoveryMethod}),el(i,m.id,m.event,{entropyId:o.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,recoveryMethod:m.data.recoveryMethod})}case"privy:wallets:recover":{let a=await (0,s.uP)({...m.data,appId:N,appClientId:n,userId:P,clientAnalyticsId:e.clientAnalyticsId,clientType:ei(window)});return r(N,P,a),l("".concat(t,"_completed"),{entropyId:a.entropyId}),el(i,m.id,m.event,{entropyId:a.entropyId})}case"privy:wallets:rpc":{let d=await (0,s.JG)({...m.data,appId:N,userId:P,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,cachedWalletData:a.current}),o=await W(d,m.data);return r(N,P,d),l("".concat(t,"_completed"),{address:d.wallet.address,method:o.method,...m.data.requesterAppId&&{requesterAppId:m.data.requesterAppId}}),el(i,m.id,m.event,{address:d.wallet.address,response:o})}case"privy:wallet:create":{let r;m.data.solanaAddress&&(r=(await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.solanaAddress,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""})).entropy);let{wallet:d}=await (0,s.io)({appId:N,appClientId:n,userId:P,accessToken:g,existingEntropy:r,clientType:ei(window),createWalletEvent:l,recoveryPassword:m.data.recoveryPassword,recoveryMethod:m.data.recoveryMethod,recoveryAccessToken:m.data.recoveryAccessToken,recoveryPin:m.data.recoveryPin,recoveryKey:m.data.recoveryKey,recoverySecretOverride:m.data.recoverySecretOverride,iCloudRecordNameOverride:m.data.iCloudRecordNameOverride});return l("".concat(t,"_completed"),{address:d.address}),el(i,m.id,m.event,{address:d.address})}case"privy:wallet:create-additional":let u=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.primaryWalletAddress,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""});X(u);let{entropy:v}=u,h=await (0,s.h6)({...m.data,appId:N,appClientId:n,entropy:v});return l("".concat(t,"_completed"),{address:h.address}),el(i,m.id,m.event,{address:h.address});case"privy:wallet:import":case"privy:wallets:import":{let{wallet:e}=await Y({appId:N,appClientId:n,userId:P,accessToken:g,privateKey:m.data.privateKey,chainType:"chainType"in m.data?m.data.chainType:"ethereum"});return l("".concat(t,"_completed"),{address:e.address}),el(i,m.id,m.event,{address:e.address})}case"privy:wallet:set-recovery-password":case"privy:wallet:set-recovery":{let r=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if("ethereum"!==r.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let d="privy:wallet:set-recovery"===m.event?m.data:{...m.data,recoveryMethod:"user-passcode"};X(r);let o=await (0,s._U)({appId:N,appClientId:n,userId:P,accessToken:g,entropy:r.entropy,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",clientType:ei(window),recoveryOptions:d,createWalletEvent:l});return l("".concat(t,"_completed"),{address:o.entropyId,existingRecoveryMethod:d.existingRecoveryMethod,targetRecoveryMethod:d.recoveryMethod}),el(i,m.id,m.event,{address:o.entropyId})}case"privy:wallet:connect":return await q({appId:N,userId:P,address:m.data.address}),el(i,m.id,m.event,{address:m.data.address});case"privy:wallet:recover":let f=await (0,s.uP)({appId:N,clientAnalyticsId:e.clientAnalyticsId,appClientId:n,userId:P,accessToken:g,clientType:ei(window),entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",recoveryPassword:m.data.recoveryPassword||m.data.recoveryPin,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty,recoveryAccessToken:m.data.recoveryAccessToken,recoverySecretOverride:m.data.recoverySecretOverride});return r(N,P,f),l("".concat(t,"_completed"),{address:f.wallet.address}),el(i,m.id,m.event,{address:f.wallet.address});case"privy:wallet:rpc":{let d=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:null!==(c=m.data.hdWalletIndex)&&void 0!==c?c:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if(r(N,P,d),"ethereum"!==d.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let o=await (0,s.jt)(d,m.data.request);return l("".concat(t,"_completed"),{address:d.wallet.address,method:o.method,...m.data.requesterAppId&&{requesterAppId:m.data.requesterAppId}}),el(i,m.id,m.event,{address:m.data.address,response:o})}case"privy:solana-wallet:create":{let r;if(m.data.ethereumAddress){let t=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.ethereumAddress,entropyIdVerifier:"ethereum-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});X(t),r=t.entropy}let{wallet:d}=await (0,s.kL)({appId:N,appClientId:n,userId:P,accessToken:g,existingEntropy:r});return l("".concat(t,"_completed"),{publicKey:d.address}),el(i,m.id,m.event,{publicKey:d.address})}case"privy:solana-wallet:create-additional":{let r=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,userId:P,entropyId:m.data.primaryPublicKey,entropyIdVerifier:"solana-address-verifier",chainType:"solana",clientAnalyticsId:e.clientAnalyticsId,hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""}),{address:d}=await E({appId:N,appClientId:n,accessToken:g,hdWalletIndex:m.data.hdWalletIndex,entropy:r.entropy});return l("".concat(t,"_completed"),{address:d}),el(i,m.id,m.event,{publicKey:d})}case"privy:solana-wallet:connect":return await q({appId:N,userId:P,address:m.data.publicKey}),el(i,m.id,m.event,{publicKey:m.data.publicKey});case"privy:solana-wallet:recover":let T=await (0,s.uP)({appId:N,appClientId:n,userId:P,accessToken:g,entropyId:m.data.publicKey,entropyIdVerifier:"solana-address-verifier",mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty,clientAnalyticsId:e.clientAnalyticsId,clientType:ei(window),recoveryAccessToken:m.data.recoveryAccessToken,recoverySecretOverride:m.data.recoverySecretOverride,recoveryPassword:m.data.recoveryPassword});return r(N,P,T),l("".concat(t,"_completed"),{publicKey:m.data.publicKey}),el(i,m.id,m.event,{publicKey:m.data.publicKey});case"privy:solana-wallet:rpc":let D=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.publicKey,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:null!==(p=m.data.hdWalletIndex)&&void 0!==p?p:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if(r(N,P,D),"solana"!==D.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let b=await (0,s.Zv)(D.wallet.keypair,m.data);return l("".concat(t,"_completed"),{method:b.method,publicKey:m.data.publicKey}),el(i,m.id,m.event,{publicKey:m.data.publicKey,response:b});case"privy:delegated-actions:consent":{let t;if("ethereum"===m.data.rootWallet.chainType){let r=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.rootWallet.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});X(r),t=r.entropy}else if("solana"===m.data.rootWallet.chainType){let r=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.rootWallet.address,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});X(r),t=r.entropy}else throw new A.Pi("invalid_request_arguments","Unexpected chain type for root delegation wallet");return await O({entropy:t,delegatedWallets:m.data.delegatedWallets,appId:N,appClientId:n,accessToken:g}),el(i,m.id,m.event,{success:!0})}case"privy:mfa:verify":return await J({appId:N,appClientId:n,userId:P,...m.data}),el(i,m.id,m.event,{});case"privy:mfa:init-enrollment":{let e=await H({appId:N,appClientId:n,userId:P,...m.data});return el(i,m.id,m.event,{method:m.data.method,secret:e.totpSecret,authUrl:e.totpAuthUrl})}case"privy:mfa:submit-enrollment":return await $({appId:N,appClientId:n,userId:P,...m.data}),el(i,m.id,m.event,{});case"privy:mfa:unenroll":return await Q({appId:N,appClientId:n,userId:P,...m.data}),el(i,m.id,m.event,{});case"privy:auth:unlink-passkey":return await ee({appId:N,appClientId:n,userId:P,...m.data}),el(i,m.id,m.event,{});case"privy:farcaster:init-signer":{let d=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:null!==(_=m.data.hdWalletIndex)&&void 0!==_?_:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});r(N,P,d),X(d);let{entropy:o}=d,c=await S({appId:N,appClientId:n,entropy:o,accessToken:m.data.accessToken});return l("".concat(t,"_completed"),{address:d.wallet.address}),el(i,m.id,m.event,c)}case"privy:farcaster:sign":{let o=await (0,s.JG)({cachedWalletData:a.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});r(N,P,o);let c=d._d.toBuffer(m.data.payload.hash);X(o);let{entropy:p}=o,{privateKey:y}=await C(p),_=function(e){let{farcasterSignerPrivateKey:a,hash:t}=e;if(20!==t.length){let e=R.from(t).toString("utf-8");try{M.parse(e)}catch(e){throw Error("Invalid blake3 hash length. Expected 20 bytes.")}}return x.ev.sign(t,a)}({farcasterSignerPrivateKey:y,hash:c});return l("".concat(t,"_completed"),{address:o.wallet.address}),el(i,m.id,m.event,{hash:m.data.payload.hash,signature:d._d.fromBuffer(_)})}}}catch(e){if((0,A.$J)(e))return P&&z.A.del({appId:N,userId:P}),es(i,m.id,m.event,new A.Pi("missing_or_invalid_mfa","MFA verification failed"));if(function(e){var a,t;let r=null===(a=e.data)||void 0===a?void 0:a.code,n=[l.si.INVALID_DATA,l.si.NOT_SUPPORTED,l.si.INVALID_DATA,l.si.NOT_SUPPORTED,l.si.USER_UNSUBSCRIBED].includes(r);return(null===(t=e.response)||void 0===t?void 0:t.status)===422&&n}(e))return P&&z.A.del({appId:N,userId:P}),es(i,m.id,m.event,new A.Pi("twilio_verification_failed",null!==(v=null===(u=e.data)||void 0===u?void 0:u.error)&&void 0!==v?v:"MFA enrollment failed"));es(i,m.id,m.event,e);return}}return en(window)?document.addEventListener("message",i):window.addEventListener("message",i),()=>{en(window)?document.removeEventListener("message",i):window.removeEventListener("message",i)}},[e.allowedDomains,e.appId,e.appClientId]),null}var ep=!0;function ey(e){let{appId:a,appClientId:t,clientAnalyticsId:n,allowedDomains:d,apiUrl:o,verificationKeys:l}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Wallet \xb7 Privy"})}),(0,r.jsx)(ec,{verificationKeys:l,appId:a,appClientId:t,clientAnalyticsId:n,allowedDomains:d,apiUrl:o})]})}},45379:(e,a,t)=>{"use strict";a.Lv=function(e,a){let t=(0,i.encrypt)(e,d.encode(a)),n={cipherText:o(t.cipherText),ephemeralPublicKey:o(t.ephemeralPublicKey),nonce:o(t.nonce),version:1};return r.base64.encode(d.encode(JSON.stringify(n)))};let r=t(56710),n=t(75995),i=t(6834);t(6834),new TextDecoder;let d=new TextEncoder;function o(e){return btoa(String.fromCharCode(...e))}n.z.object({cipherText:n.z.string(),ephemeralPublicKey:n.z.string(),nonce:n.z.string(),version:n.z.literal(1)}).required()},6834:function(e,a,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0}),a.generateKeyPair=d,a.encrypt=function(e,a){let t=d(),r=n.default.randomBytes(n.default.box.nonceLength);return{cipherText:n.default.box(a,r,e,t.privateKey),ephemeralPublicKey:t.publicKey,nonce:r}},a.decrypt=function(e,a){let t=n.default.box.open(a.cipherText,a.nonce,a.ephemeralPublicKey,e);if(null===t)throw new i.DecryptionError("Decryption failed");return t};let n=r(t(82926)),i=t(96375);function d(){let e=n.default.box.keyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}}},96375:(e,a)=>{"use strict";function t(e){return class extends Error{constructor(a){super(a),this.name=e}}}Object.defineProperty(a,"__esModule",{value:!0}),a.EncryptionKeyError=a.EncryptionSizeError=a.DecryptionError=void 0,a.DecryptionError=t("DecryptionError"),a.EncryptionSizeError=t("EncryptionSizeError"),a.EncryptionKeyError=t("EncryptionKeyError")},79629:(e,a,t)=>{"use strict";t.d(a,{oC:()=>d,ZT:()=>l,si:()=>n,D_:()=>o});var r,n=((r={}).OAUTH_ACCOUNT_SUSPENDED="oauth_account_suspended",r.MISSING_OR_INVALID_PRIVY_APP_ID="missing_or_invalid_privy_app_id",r.MISSING_OR_INVALID_PRIVY_CLIENT_ID="missing_or_invalid_privy_client_id",r.MISSING_OR_INVALID_PRIVY_ACCOUNT_ID="missing_or_invalid_privy_account_id",r.MISSING_OR_INVALID_TOKEN="missing_or_invalid_token",r.MISSING_OR_INVALID_MFA="missing_or_invalid_mfa",r.EXPIRED_OR_INVALID_MFA_TOKEN="expired_or_invalid_mfa_token",r.INVALID_DATA="invalid_data",r.INVALID_CREDENTIALS="invalid_credentials",r.INVALID_CAPTCHA="invalid_captcha",r.LINKED_TO_ANOTHER_USER="linked_to_another_user",r.ALLOWLIST_REJECTED="allowlist_rejected",r.CANNOT_UNLINK_EMBEDDED_WALLET="cannot_unlink_embedded_wallet",r.CANNOT_UNLINK_SOLE_ACCOUNT="cannot_unlink_sole_account",r.CANNOT_LINK_MORE_OF_TYPE="cannot_link_more_of_type",r.LINKED_ACCOUNT_NOT_FOUND="linked_account_not_found",r.TOO_MANY_REQUESTS="too_many_requests",r.INVALID_ORIGIN="invalid_origin",r.MISSING_ORIGIN="missing_origin",r.INVALID_NATIVE_APP_ID="invalid_native_app_id",r.TOKEN_ALREADY_USED="token_already_used",r.ALREADY_LOGGED_OUT="already_logged_out",r.NOT_SUPPORTED="not_supported",r.USER_UNSUBSCRIBED="user_unsubscribed",r.MAX_APPS_REACHED="max_apps_reached",r.USER_LIMIT_REACHED="max_accounts_reached",r.DEVICE_REVOKED="device_revoked",r.WALLET_PASSWORD_EXISTS="wallet_password_exists",r.OAUTH_STATE_MISMATCH="oauth_state_mismatch",r.MAX_DENYLIST_ENTRIES_REACHED="max_denylist_entries_reached",r.DISALLOWED_LOGIN_METHOD="disallowed_login_method",r.DISALLOWED_PLUS_EMAIL="disallowed_plus_email",r.DISALLOWED_RECOVERY_METHOD="disallowed_recovery_method",r.LEGACY_DASHBOARD_LOGIN_CONFIGURATION="legacy_dashboard_login_configuration",r.CANNOT_SET_PASSWORD="cannot_set_password",r.INVALID_PKCE_PARAMETERS="invalid_pkce_parameters",r.INVALID_APP_URL_SCHEME_CONFIGURATION="invalid_app_url_scheme_configuration",r.CROSS_APP_CONNECTION_NOT_ALLOWED="cross_app_connection_not_allowed",r.USER_DOES_NOT_EXIST="user_does_not_exist",r.ACCOUNT_TRANSFER_REQUIRED="account_transfer_required",r.USER_HAS_NOT_DELEGATED_WALLET="user_has_not_delegated_wallet",r.FEATURE_NOT_ENABLED="feature_not_enabled",r.INSUFFICIENT_FUNDS="insufficient_funds",r.TRANSACTION_BROADCAST_FAILURE="transaction_broadcast_failure",r.INVALID_POLICY_FORMAT="invalid_policy_format",r.POLICY_VIOLATION="policy_violation",r);class i extends Error{toString(){return`${this.constructor.name}: ${this.message}${this.cause?` [cause: ${this.cause}]`:""}`}constructor(e,a,t,r){super(a),this.code=t,this.status=e,this.responseData=r}}class d extends i{constructor(e,a){super(400,e,a||n.INVALID_DATA)}}class o extends i{constructor(e,a){super(401,e,a)}}class l extends i{constructor(e,a){super(422,e,a)}}var s=t(46195);s.z.object({error:s.z.string(),cause:s.z.string().optional(),code:s.z.nativeEnum(n).optional()})}},e=>{var a=a=>e(e.s=a);e.O(0,[2968,8610,6195,1963,2406,7338,1307,178,3138,6814,636,6593,8792],()=>a(290)),_N_E=e.O()}]);